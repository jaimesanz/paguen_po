{% extends "base.html" %}
{% load bootstrap3 %}
{% load humanize %}

{% block content_title %}{{vivienda_usuario.vivienda}}{% endblock %}
{% block content %}
	<h3>Detalle Gasto</h3>
	{% if gasto.is_pending %}
		<form method="post" action="">
			{% csrf_token %}
			<table id="gasto_detail" class="table table-striped table-bordered" cellspacing="0" width="100%">
				<thead>
					<tr>
					</tr>
				</thead>
				<tbody>
					<tr>
					    <td><b>Monto:</b> </td>
					    <td>$ {{gasto.monto|intcomma }}</td>
					</tr>
					<tr>
					    <td><b>Categoría:</b> </td>
					    <td>{{ gasto.categoria }}</td>
					</tr>
				</tbody>
			</table>
			<button type="submit" class="btn btn-primary">Pagar</button>
		</form>
	{% else %}
		<table id="gasto_detail" class="table table-striped table-bordered" cellspacing="0" width="100%">
			<thead>
				<tr>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><b>Monto:</b> </td>
					<td>$ {{gasto.monto|intcomma}}</td>
				</tr>
				<tr>
					<td><b>Creado por:</b></td>
					<td>{{gasto.creado_por.user}}</td>
				</tr>
				<tr>
					<td><b>Usuario:</b></td>
					<td>{{gasto.usuario.user}}</td>
				</tr>
				<tr>
					<td><b>Categoría:</b></td>
					<td>{{gasto.categoria}}</td>
				</tr>
				<tr>
					<td><b>Fecha creacion:</b></td>
					<td>{{gasto.fecha_creacion}}</td>
					</tr>
				<tr>
					<td><b>Fecha pago:</b></td>
					<td>{{gasto.fecha_pago}}</td>
				</tr>
				<tr>
					<td><b>Periodo:</b></td>
					<td>{{gasto.year_month}}</td>
				</tr>
				{% if gasto.lista_compras %}
					<tr>
						<td><b>Lista compras:</b></td>
						<td><a href="/detalle_lista/{{gasto.lista_compras.id}}/">ver detalle</a></td>
					</tr>
				{% endif %}
				<tr>
					<td><b>Estado:</b></td>
					<td>{{gasto.estado}}</td>
				</tr>
                {% if gasto.is_pending_confirm %}
                    <tr>
                        <td><b>Confirmado por:</b></td>
                        <td>
                        {% for cg in gasto.get_confirmed_users %}
                            {{ cg.vivienda_usuario__user__username }}
                        {% endfor %}
                        </td>
				    </tr>
                    <tr>
                        <td><b>Por confirmar:</b></td>
                        <td>
                        {% for cg in gasto.get_unconfirmed_users %}
                            {{ cg.vivienda_usuario__user__username }}
                        {% endfor %}
                        </td>
				    </tr>
                {% endif %}
			</tbody>
		</table>
        {% if show_confirm_form %}
            <form method="post" action="/confirm/{{ gasto.id }}/">
			    {% csrf_token %}
                <button type="submit" class="btn
                btn-primary">Confirmar</button>
            </form>
        {% endif %}
	{% endif %}
    {% if show_edit_button %}
        <a href="/edit_gasto/{{ gasto.id }}" class="btn btn-warning" role="button">
            {% bootstrap_icon "pencil" %} Editar
        </a>
    {% endif %}
{% endblock %}
